# malongyu 2300930
from Offline_least_squares_method.founction import *

X = [1.642,0.715,0.39,0.35]
U = [1.147,0.201,-0.787,-1.159,-1.052,0.866,1.152,1.573,0.626,0.433,-0.958,0.810,-0.044,0.947,-1.474,-0.719,-0.086,-1.099,1.450,1.151,0.485,1.633,0.043,1.326,1.706,-0.340,0.890,1.144,1.177,-0.390]
U = [num*100 for num in U]
noise = 1
if noise == False:
    Y = calculate_y(X = X, U = U,noise = False)
else:
    Y,error = calculate_y(X = X, U = U, noise=True)
    print(error)
X = get_x(Y,U)
print(X)
# Y1 Y2默认为0
Y = Y[2:]
print(list(Y))
result = compute_matrix_expression(X, Y)
print(list(result))

over = 0
if over==0:
    '''
    data = [[1.564811828328155, 0.6682046654571989, 0.38729573887369945, 0.3463550512257876],
            [1.6793176331088397, 0.7547078228648494, 0.39549631243332145, 0.39494539569799764],
            [1.4242538029352874, 0.4367894241508745, 0.32992323950247093, 0.2950023026861487],
            [1.72977142879706, 0.7650926082028802, 0.5706491743808453, 0.33022523929360936],
            [1.5522572823814615, 0.6959631716061518, 0.32105962854700865, 0.29040580058997945],
            [1.650463252414323, 0.6426187736172007, 0.5122072830354145, 0.2566259106200267],
            [1.699491855236202, 0.7781126424478093, 0.37967752958360956, 0.24686361699058135]
            ]
    '''
    data = [[1.64201533092846, 0.715050855264413, 0.3899843209978416, 0.35000109991327144],
            [1.6396080494047531, 0.7133923786914353, 0.39038816395433174, 0.3489986300903467],
            [1.6417104431007208, 0.714762587816856, 0.3901178609713368, 0.3498378674038878],
            [1.6365035709323852, 0.7125995113216916, 0.3900271690976747, 0.3483377757536468],
            [1.6455859483604054, 0.7177080024467515, 0.3895287378895549, 0.351203698881819],
            [1.6418602681294394, 0.7129947791431852, 0.3895380608697505, 0.35120751344201007],
            [1.5685308598825682, 0.6460804988901588, 0.37097412316192335, 0.32403263409330263]
            ]

    import matplotlib.pyplot as plt
    import numpy as np
    import matplotlib

    matplotlib.rc("font", family='Microsoft YaHei')
    x = ['a1', 'a2', 'b1', 'b2']
    label = ['标准差：0.05','标准差：0.1','标准差：0.2','标准差：0.3','标准差：0.4','标准差：0.5','标准差：10']
    for i in range(len(data)):
        plt.plot(x, data[i],label=label[i])
    plt.plot(x, [1.642000000000011, 0.7150000000000083, 0.38999999999999985, 0.35000000000000386], label='真实值',linestyle='--')
    # 添加图例
    plt.legend()
    plt.title('噪声对离线辨识参数的影响')

    # 显示图形
    plt.show()